<!DOCTYPE html>
<html>
	<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
      <meta name="description" content="quick tricks for product filter" />
    
    
      <meta name="keywords" content="quick-tricks product-filter-spree spree krazedkrish blog ">
    
    <meta name="author" content="Shalil Awaley">

    <title>Dumb and Cheap Hack for Product Filter in Spree</title>

    <link rel="canonical" href="http://krazedkrish.com/blog/2016/01/27/dumb-and-cheap-hack-for-product-filter-in-spree/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/blog/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/blog/css/landing-page.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="/blog/css/syntax.css">

    <!-- Custom Fonts -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="http://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic,700italic" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <script src="//load.sumome.com/" data-sumo-site-id="b69bfe6ce63ca7cb0c4751c89e49217bb06a757a6d64ce3b381c6c921972f81d" async="async"></script>
</head>


	<body id="index">
		<header id="blog">
    <!-- Navigation -->
    <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
        <div class="container">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand page-scroll" href="http://krazedkrish.com#home">krazedkrish</a>
            </div>
            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav">
                    <li>
                        <a class="page-scroll" href="/#about">About</a>
                    </li>
                    <li>
                      <a class="page-scroll" href="/#services">Services</a>
                    </li>
                    <li>
                        <a class="page-scroll" href="/#recent">Recent Works</a>
                    </li>
                    <li>
                        <a class="page-scroll" href="/#contact">Contact</a>
                    </li>
                </ul>
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/projects">Projects</a>
                    </li>
                    <li>
                        <a href="/blog">Blog</a>
                    </li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>
</header>

    <section id="blog">
        <div class="post-header">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>Dumb and Cheap Hack for Product Filter in Spree</h1>
                    
                    <h2 class="post-subheading">Spree: Feeling lazy, here is how to build easy Product Filters</h2>
                    
                    <span class="meta">Posted by <a href="https://twitter.com/krazedkrish">@krazedkrish</a > on January 27, 2016</span>
                </div>
            </div>
        </div>
    </div>
    <!-- /.container -->
</div>
<!-- /.page-header -->


<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">

                <blockquote>
  <p>Disclaimer:</p>
  <p>This is not a standard way to create product filter. But its quick and it works.</p>
  <p>If you want to follow the standard follow <a href="https://github.com/spree/spree/blob/master/core/lib/spree/core/product_filters.rb" target="_blank">this sample/guide</a>.</p>
</blockquote>
<h1>Quick tricks for Product Filter</h1>
<p>Here is how to do it:</p>
<h4>1. create <em>/lib/spree/custom_search.rb</em> file in your project folder</h4>
<h4>2. add <code>require "#{Rails.root}/lib/spree/custom_search"</code> to <em>/config/initializers/spree.rb</em></h4>
<h4>3. create the module for ProductFilters</h4>
<div class="highlight"><pre><span class="k">module</span> <span class="nn">Spree</span>
  <span class="k">module</span> <span class="nn">Core</span>
    <span class="k">module</span> <span class="nn">ProductFilters</span>

    <span class="o">.</span><span class="n">.</span><span class="o">.</span>
    <span class="c1"># your search scopes here</span>
    <span class="o">.</span><span class="n">.</span><span class="o">.</span>

    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>
<h4>4. add the search scopes required.</h4>
<div class="highlight"><pre><span class="k">module</span> <span class="nn">Spree</span>
  <span class="k">module</span> <span class="nn">Core</span>
    <span class="k">module</span> <span class="nn">ProductFilters</span>

    <span class="c1"># example scope</span>
    <span class="c1"># may be you guys can opitmize/shorten 2 queries in 1</span>
    <span class="c1"># I will be glad, if you include it in comments</span>
    <span class="no">Spree</span><span class="o">::</span><span class="no">Product</span><span class="o">.</span><span class="n">add_search_scope</span> <span class="ss">:in_taxonomy</span> <span class="k">do</span> <span class="o">|</span><span class="n">taxonomy</span><span class="o">|</span>
      <span class="n">taxons</span><span class="o">=</span><span class="no">Spree</span><span class="o">::</span><span class="no">Taxonomy</span><span class="o">.</span><span class="n">includes</span><span class="p">(</span><span class="ss">taxons</span><span class="p">:</span> <span class="ss">:products</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="ss">:id</span><span class="o">=&gt;</span><span class="n">taxonomy</span><span class="p">)</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="ss">:id</span><span class="p">)</span><span class="o">.</span><span class="n">map</span> <span class="o">&amp;</span><span class="ss">:taxon_ids</span>
      <span class="n">taxons</span><span class="o">=</span><span class="n">taxons</span><span class="o">.</span><span class="n">flatten</span>

      <span class="c1"># the line below will be concatinated to the select query for the product</span>
      <span class="c1"># so you dont have to with &quot;Spree::Product...&quot;</span>
      <span class="n">in_taxons</span><span class="p">(</span><span class="n">taxons</span><span class="p">)</span>
    <span class="k">end</span>

    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>
<p>Again, this is not a standard approach. But If all you need is to add one line why follow the standard Product Filter.
  Standards are to ease the development time. What if! not following the standards does less harm and more good, I say:</p>
<blockquote>
  <p>&#8220;Be agile and lazy! Be awesome!!&#8221;</p>
</blockquote>
<p>You dont agree with me. No Problem! Here are some useful reference for you for building standard ones.</p>
<ul>
  <li><a href="https://github.com/spree/spree/blob/master/core/lib/spree/core/product_filters.rb" target="_blank">&lt;spree gem&gt;/core/lib/spree/core/product_filters.rb</a></li>
  <li><a href="https://gist.github.com/maxivak/cc73b88699c9c6b45a95" target="_blank">https://gist.github.com/maxivak/cc73b88699c9c6b45a95</a></li>
  <li><a href="https://gist.github.com/Ranger-X/2511088" target="_blank">https://gist.github.com/Ranger-X/2511088</a></li>
  <li><a href="https://gist.github.com/berkes/1931810" target="_blank">https://gist.github.com/berkes/1931810</a></li>
  <li><a href="https://gist.github.com/killthekitten/4486585" target="_blank">https://gist.github.com/killthekitten/4486585</a></li>
</ul>


                <hr>

                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/blog/2015/12/27/awesome-emacs-plugins/" data-toggle="tooltip" data-placement="top" title="Awesome Emacs plugins you might not know">&larr; Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/blog/2016/02/26/notify-on-ssh-login/" data-toggle="tooltip" data-placement="top" title="How to show notification on ssh login">Next Post &rarr;</a>
                    </li>
                    
                </ul>

            </div>
        </div>
    </div>
</article>

<br />

<!-- Disqus Comment -->



<div class="container">
    <div class="row">
        <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    // Required: on line below, replace text in quotes with your forum shortname
    var disqus_shortname = 'krazedkrish';
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>


        </div>
    </div>
</div>

    </section>
		<!-- Footer -->
<footer>
    <hr class="footer-divider"/>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    
                    <li>
                        <a class="social" href="https://twitter.com/krazedkrish">
                            <span class="fa-stack fa-2x">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <!-- <i class="fa fa-twitter fa-fw"></i> -->
                                <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    <li>
                        <a class="social" href="https://github.com/krazedkrish">
                            <span class="fa-stack fa-2x">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <!-- <i class="fa fa-github fa-fw"></i> -->
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    <li>
                        <a class="social" href="https://np.linkedin.com/pub/shalil-awaley/69/618/b21">
                            <span class="fa-stack fa-2x">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <!-- <i class="fa fa-linkedin fa-fw"></i> -->
                                <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                </ul>
                <p class="copyright text-muted text-center">Copyright &copy; krazedkrish 2017</p>
            </div>
        </div>
    </div>
</footer>

		<!-- jQuery Version 1.11.0 -->
<script src="/blog/js/jquery-1.11.0.js"></script>

<!-- Plugin JavaScript -->
    <script src="/blog/js/jquery.easing.min.js"></script>

<!-- Bootstrap Core JavaScript -->
<script src="/blog/js/bootstrap.min.js"></script>

<!-- Custom Theme JavaScript -->
<script src="/blog/js/landing-page.js"></script>

<!-- Contact Validation JavaScript -->
<script src="/blog/js/concact-validate.js"></script>

    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66064598-1', 'auto');
  ga('send', 'pageview');

</script>

	</body>
</html>
